!function(){"use strict";angular.module("app",["app.core","app.filters","app.router","app.components","app.services","app.login","app.dashboard","app.material","app.resource","app.plan"])}(),function(){"use strict";angular.module("app.components",[])}(),function(){"use strict";angular.module("app.core",["ui.router","ngResource","angular-jsoneditor"])}(),function(){"use strict";angular.module("app.dashboard",["app.core"])}(),function(){"use strict";angular.module("app.filters",[])}(),function(){"use strict";angular.module("app.login",["app.core"])}(),function(){"use strict";angular.module("app.material",["app.core"])}(),function(){"use strict";angular.module("app.plan",["app.core"])}(),function(){"use strict";angular.module("app.resource",["app.core"])}(),function(){"use strict";angular.module("app.router",["ui.router"])}(),function(){"use strict";angular.module("app.services",[])}(),function(){"use strict";function e(e){function t(e,t,r){t.bind("change",function(t){var r=t.target.files[0],n=new FileReader;n.onload=function(t){var n="image"===r.type.substring(0,5);e.fileread={url:t.target.result,size:r.size,type:r.type,name:r.name,isImage:n},e.$apply()},n.readAsDataURL(r)})}var r={restrict:"A",scope:{fileread:"="},link:t};return r}angular.module("app.components").directive("fileread",e),e.$inject=["$parse"]}(),function(){"use strict";function e(e){function t(e,t,r){t.bind("change",function(t){var r=t.target.files;e.filereadMultiple=e.filereadMultiple||[];for(var n=0;n<r.length;n++)!function(t){var r=new FileReader;r.onload=function(r){var n="image"===t.type.substring(0,5);e.filereadMultiple.push({url:r.target.result,size:t.size,type:t.type,name:t.name.substring(0,t.name.lastIndexOf(".")),isImage:n}),e.$apply()},r.readAsDataURL(t)}(r[n])})}var r={restrict:"A",scope:{filereadMultiple:"="},link:t};return r}angular.module("app.components").directive("filereadMultiple",e),e.$inject=["$parse"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"../../templates/components/flashMessage.html"};return e}angular.module("app.components").directive("flashMessage",e)}(),function(){"use strict";function e(e){function t(t,r,n){$(r).find(".modal").modal(),$(document).on("blur",".jsoneditor-value",function(e){window.editEle=e.currentTarget}),t.getList=function(r){var n={};n.materialType="image",void 0!==r&&(n.page=r),e({method:"GET",url:"/node/material",params:n}).then(function(e,r,n,a){t.list=e.data.data,t.totalPage=e.data.totalPage,t.perpage=e.data.perpage,t.page=e.data.page},function(e,t,r,n){console.log("error")})},t.getList(),t.selectImage=function(e){t.choose=e},t.insertImage=function(){window.editEle.innerHTML=t.choose.content,$(window.editEle).focus().blur().focus()}}var r={restrict:"EAC",scope:{choose:"="},templateUrl:"../../templates/components/imageChoose.html",link:t};return r}angular.module("app.components").directive("imageChoose",e),e.$inject=["$http"]}(),function(){"use strict";function e(){var e={restrict:"E",scope:{},template:'<div class="preloader-wrapper active">    <div class="spinner-layer spinner-red-only">      <div class="circle-clipper left">        <div class="circle"></div>      </div><div class="gap-patch">        <div class="circle"></div>      </div><div class="circle-clipper right">        <div class="circle"></div>      </div>    </div>  </div>'};return e}angular.module("app.components").directive("pageLoading",e)}(),function(){"use strict";function e(){var e={restrict:"E",scope:!1,link:function(e,t,r){if("text/javascript-lazy"===r.type){var n=document.createElement("script");n.type="text/javascript";var a=t.attr("src");if(void 0!==a)n.src=a;else{var o=t.text();n.text=o}document.head.appendChild(n)}}};return e}angular.module("app.components").directive("script",e)}(),function(){"use strict";function e(e){function t(t,r,n){$(r).find(".modal").modal(),$(document).on("blur",".jsoneditor-value",function(e){window.editEle=e.currentTarget}),t.getList=function(r){var n={};n.materialType="text",void 0!==r&&(n.page=r),e({method:"GET",url:"/node/material",params:n}).then(function(e,r,n,a){t.list=e.data.data,t.totalPage=e.data.totalPage,t.perpage=e.data.perpage,t.page=e.data.page},function(e,t,r,n){console.log("error")})},t.getList(),t.selectText=function(e){t.choose=e},t.insertText=function(){window.editEle.innerHTML=_.escape(t.choose.content),$(window.editEle).focus().blur().focus()}}var r={restrict:"EAC",scope:{choose:"="},templateUrl:"../../templates/components/textChoose.html",link:t};return r}angular.module("app.components").directive("textChoose",e),e.$inject=["$http"]}(),function(){"use strict";function e(){var e={restrict:"EA",scope:!1,link:function(e,t,r){window.ue&&UE.getEditor("UEcontainer").destroy(),window.ue=UE.getEditor("UEcontainer")}};return e}angular.module("app.components").directive("ueditor",e)}(),function(){"use strict";function e(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|sms|data):/)}function t(e){e.interceptors.push("UserInterceptor")}angular.module("app.core").config(e).config(t),e.$inject=["$compileProvider"],t.$inject=["$httpProvider"]}(),function(){"use strict";function e(e){var r="/dashboard";e.configureStates(t(),r)}function t(){return[{state:"root",config:{url:"","abstract":!0,views:{"header@root":{templateUrl:"templates/layout/header.html"},"sidebar@root":{templateUrl:"templates/layout/sildebar.html"},"@":{templateUrl:"templates/layout/master.html"}}}},{state:"404",config:{url:"/404",templateUrl:"templates/error/404.html",title:"404"}}]}angular.module("app.core").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r){return{responseError:function(t){var n=t.data;return 0===n.code&&r.path("/login"),e.reject(t)},response:function(e){return e},request:function(e){return e},requestError:function(t){return e.reject(t)}}}angular.module("app.core").factory("UserInterceptor",e),e.$inject=["$q","$rootScope","$location"]}(),function(){"use strict";function e(e){function t(){e.get("/node/dashboard/count").success(function(e){r.materials_count=e.materials_count,r.resources_count=e.resources_count,r.plans_count=e.plans_count,r.ready=!0})}var r=this;r.ready=!1,r.getData=t,t()}angular.module("app.dashboard").controller("DashboardController",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"root.dashboard",config:{url:"/dashboard",views:{main:{templateUrl:"templates/dashboard/dashboard.html",controller:"DashboardController",controllerAs:"vm"}},title:"主面板"}}]}angular.module("app.dashboard").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(){return function(e){for(var t=[],r=0;r<e;r++)t[r]=r+1;return t}}angular.module("app.filters").filter("numToArr",e)}(),function(){"use strict";function e(){return function(e){return new Date(e).getTime()}}angular.module("app.filters").filter("dateVal",e)}(),function(){"use strict";function e(e,t){function r(){e.post("/node/user/login",n.user).success(function(e){t.go("root.dashboard")}).error(function(e){n.error=e.msg})}var n=this;n.user={},n.login=r}angular.module("app.login").controller("LoginController",e),e.$inject=["$http","$state"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"login",config:{url:"/login",templateUrl:"templates/login/login.html",controller:"LoginController",controllerAs:"vm",title:"登录"}}]}angular.module("app.login").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r,n){function a(e){s.ready=!1;var t={};t.materialType=s.typeFilter,void 0!==e&&(t.page=e);var n=r.query(t,function(){s.list=n.data,s.totalPage=n.totalPage,s.page=n.page,s.totalNum=n.totalNum,s.ready=!0})}function o(){var e=window.ue.getContent(),t={content:e,materialName:s.material.materialName,materialType:"text"},a=new r(t);a.$save(function(){Materialize.toast("上传素材成功!",4e3),setTimeout(function(){n.go("root.material")},1e3)})}function i(){s.loading=!0;var e=new r({files:s.material.files});e.$save(function(){s.loading=!1,Materialize.toast("上传素材成功!",4e3),setTimeout(function(){n.go("root.material")},1e3)})}function l(){r.get({id:t.id},function(e){s.material=e,setTimeout(function(){window.ue.setContent(e.content)},2e3)})}function c(e){r.get({id:e},function(t){t.$delete({id:e},function(){Materialize.toast("删除素材成功",4e3),s.getData()})})}function u(){var e=window.ue.getContent();r.get({id:t.id},function(r){r.content=e,r.materialName=s.material.materialName,r.$save({id:t.id},function(){Materialize.toast("更新素材成功",4e3),s.getMaterial()})})}var s=this;s.typeFilter="image",s.getData=a,s.uploadText=o,s.uploadImage=i,s.getMaterial=l,s.updateMaterial=u,s.delMaterial=c}angular.module("app.material").controller("MaterialController",e),e.$inject=["$http","$stateParams","Material","$state"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"root.material",config:{url:"^/material",views:{"main@root":{templateUrl:"templates/material/materialList.html",controller:"MaterialController",controllerAs:"vm"}},title:"素材列表"}},{state:"root.material.create",config:{url:"^/material/create",views:{"main@root":{templateUrl:"templates/material/createMaterial.html",controller:"MaterialController",controllerAs:"vm"}},title:"编辑素材"}},{state:"root.material.edit",config:{url:"^/material/:id",views:{"main@root":{templateUrl:"templates/material/editMaterial.html",controller:"MaterialController",controllerAs:"vm"}},title:"编辑素材"}}]}angular.module("app.material").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r,n,a,o){function i(e){m.ready=!1;var t={};""!==m.plan.effective&&void 0!==m.plan.effective&&(t.effective=m.plan.effective),void 0!==e&&(t.page=e);var r=n.query(t,function(){m.list=r.data,m.totalPage=r.totalPage,m.page=r.page,m.totalNum=r.totalNum,m.ready=!0})}function l(){m.ready=!1,a.get({id:t.id},function(e){m.resource=e,m.resource["interface"]=JSON.parse(m.resource["interface"]),m.plan["interface"]=angular.copy(m.resource["interface"]),m.ready=!0})}function c(){m.plan.startTime=r("date")(m.plan.startTime,"yyyy-MM-dd HH:mm:ss"),m.plan.endTime=r("date")(m.plan.endTime,"yyyy-MM-dd HH:mm:ss");var e=angular.extend(m.plan,{resource_id:m.resource.id}),t=new n(e);t.$save(function(){Materialize.toast("创建计划成功!",4e3),setTimeout(function(){o.go("root.plan")},1e3)})}function u(){m.ready=!1,n.get({id:t.id},function(e){m.plan=e,m.plan.startTime=new Date(m.plan.startTime),m.plan.endTime=new Date(m.plan.endTime),m.plan["interface"]=JSON.parse(m.plan["interface"]),m.ready=!0})}function s(){m.options.mode="form"==m.options.mode?"code":"form"}function p(e){n.get({id:e},function(t){t.$delete({id:e},function(){Materialize.toast("删除计划成功",4e3),m.getData()})})}function d(){n.get({id:t.id},function(e){angular.extend(e,m.plan),e.$save({id:t.id},function(){Materialize.toast("更新计划成功",4e3),m.getPlan()})})}function f(e,t){n.get({id:e},function(r){r.effective=t,r.$save({id:e},function(){Materialize.toast("修改计划状态成功",4e3),m.getData()})})}var m=this;m.plan={},m.now=Date.now(),m.getData=i,m.createPlan=c,m.getResource=l,m.getPlan=u,m.changeEditMode=s,m.updatePlan=d,m.delPlan=p,m.toggleStatus=f}angular.module("app.plan").controller("PlanController",e),e.$inject=["$http","$stateParams","$filter","Plan","Resource","$state"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"root.plan",config:{url:"^/plan",views:{"main@root":{templateUrl:"templates/plan/planList.html",controller:"PlanController",controllerAs:"vm"}},title:"计划列表"}},{state:"root.plan.create",config:{url:"^/resource/:id/plan/create",views:{"main@root":{templateUrl:"templates/plan/createPlan.html",controller:"PlanController",controllerAs:"vm"}},title:"资源位-新建计划"}},{state:"root.plan.edit",config:{url:"^/plan/:id",views:{"main@root":{templateUrl:"templates/plan/editPlan.html",controller:"PlanController",controllerAs:"vm"}},title:"资源位-新建计划"}}]}angular.module("app.plan").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r,n,a){function o(){p.ready=!1;var e=r.query(function(){p.list=e,p.ready=!0})}function i(){p.ready=!1,r.get({id:t.id},function(e){p.resource=e,p.resource["interface"]=JSON.parse(p.resource["interface"]),p.ready=!0})}function l(){var e=new r(p.resource);e.$save(function(){Materialize.toast("创建资源位成功!",4e3),setTimeout(function(){a.go("root.resource")},1e3)})}function c(e){r.get({id:e},function(t){t.$delete({id:e},function(){Materialize.toast("删除资源位成功",4e3),p.getList()})})}function u(){r.get({id:t.id},function(e){angular.extend(e,p.resource),e.$save({id:t.id},function(){Materialize.toast("修改资源位成功",4e3),p.getResource()})})}function s(e,t){n.get({id:e},function(r){r.effective=t,r.$save({id:e},function(){Materialize.toast("修改计划状态成功",4e3),p.getResource()})})}var p=this;p.getList=o,p.now=Date.now(),p.createResource=l,p.getResource=i,p.delResource=c,p.updateResource=u,p.toggleStatus=s,p.options={mode:"code",modes:["form","text","tree","view","code"]}}angular.module("app.resource").controller("ResourceController",e),e.$inject=["$http","$stateParams","Resource","Plan","$state"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"root.resource",config:{url:"^/resource",views:{"main@root":{templateUrl:"templates/resource/resourceList.html",controller:"ResourceController",controllerAs:"vm"}},title:"资源位列表"}},{state:"root.resource.create",config:{url:"^/resource/create",views:{"main@root":{templateUrl:"templates/resource/createResource.html",controller:"ResourceController",controllerAs:"vm"}},title:"新建资源位"}},{state:"root.resource.edit",config:{url:"^/resource/:id",views:{"main@root":{templateUrl:"templates/resource/editResource.html",controller:"ResourceController",controllerAs:"vm"}},title:"编辑资源位"}},{state:"root.resource.plan",config:{url:"^/resource/:id/plan",views:{"main@root":{templateUrl:"templates/resource/resource-planList.html",controller:"ResourceController",controllerAs:"vm"}},title:"资源位-计划"}}]}angular.module("app.resource").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r){function n(e,n,o){function i(e,n){e.forEach(function(e){e.config.resolve=angular.extend(e.config.resolve||{},a.resolveAlways),t.state(e.state,e.config)}),n&&!d&&(d=!0,r.otherwise(n))}function l(){n.$on("$stateChangeError",function(t,r,n,a,o,i){if(!p){f.errors++,p=!0;var l=r&&(r.title||r.name||r.loadedTemplateUrl)||"unknown target",c="Error routing to "+l+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");console.warn(c),e.path("/")}})}function c(){l(),s()}function u(){return o.get()}function s(){n.$on("$stateChangeSuccess",function(e,t,r,i,l){f.changes++,p=!1;var c=a.docTitle+" · "+(t.title||"");n.mainUrl=o.current.url.split("/")[1],n.title=c,window.scrollTo(0,0)})}var p=!1,d=!1,f={errors:0,changes:0},m={configureStates:i,getStates:u,stateCounts:f};return c(),m}var a={docTitle:"CMS",resolveAlways:{}};this.configure=function(e){angular.extend(a,e)},this.$get=n,n.$inject=["$location","$rootScope","$state"]}angular.module("app.router").provider("routerHelper",e),e.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e){return e("/node/material/:id",{id:"@_id"},{query:{method:"get",isArray:!1}})}angular.module("app.services").factory("Material",e),e.$inject=["$resource"]}(),function(){"use strict";function e(e){return e("/node/plan/:id",{id:"@_id"},{query:{method:"get",isArray:!1}})}angular.module("app.services").factory("Plan",e),e.$inject=["$resource"]}(),function(){"use strict";function e(e){return e("/node/resource/:id",{id:"@_id"})}angular.module("app.services").factory("Resource",e),e.$inject=["$resource"]}();